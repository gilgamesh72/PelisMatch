{% extends "base.html" %}

{% block title %}Resultados - PelisMatch{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row mb-3">
        <div class="col-12">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb bg-transparent p-0">
                    <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Inicio</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Resultados</li>
                </ol>
            </nav>
            <h2 class="text-gradient">Resultados</h2>
        </div>
    </div>

    <div id="search-info-section" class="mb-3" style="display:none;">
        <div id="algorithm-description" class="text-light small"></div>
    </div>

    <div id="base-movie-section" class="mb-4" style="display:none;">
        <div id="base-movie-content"></div>
    </div>

    <div class="row mb-2 align-items-center">
        <div class="col-md-8">
            <div class="d-flex align-items-center gap-3">
                <div>Resultados: <strong id="total-results">0</strong></div>
                <div>Procesado: <span id="processing-time">0s</span></div>
                <div>Promedio similitud: <strong id="avg-similarity">N/A</strong></div>
            </div>
        </div>
        <div class="col-md-4 text-end">
            <button class="btn btn-sm btn-outline-light" onclick="exportarResultados()">Exportar</button>
        </div>
    </div>

    <div id="loading-state" style="display:none;" class="row">
        <div class="col-12 text-center py-4 text-light">Cargando resultados...</div>
    </div>

    <div id="empty-state" class="row d-none">
        <div class="col-12 text-center py-4 text-muted">
            No se encontraron resultados. Ajusta tu búsqueda.
        </div>
    </div>

    <div id="results-container" class="row"></div>
</div>

<!-- Modal de detalles de película (llenado por JS) -->
<div class="modal fade" id="movieDetailsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content bg-dark">
            <div class="modal-header border-secondary">
                <h5 class="modal-title text-gradient">Detalles</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="movie-details-content">
                <!-- Contenido dinámico -->
            </div>
            <div class="modal-footer border-secondary">
                <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-gradient" onclick="agregarAFavoritosFromModal()">Agregar a Favoritos</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
    window.RESULTADOS_CONFIG = { index_url: "{{ url_for('index') }}" };
</script>
<script src="{{ url_for('static', filename='js/resultados.js') }}"></script>
{% endblock %}